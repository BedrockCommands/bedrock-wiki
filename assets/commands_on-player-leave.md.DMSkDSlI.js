import{_ as r}from"./chunks/6.C5WWER03.js";import{_ as c}from"./chunks/gametick.CRm9ZPR8.js";import{_ as p,e as d,t as a,C as o,Q as s,f as e,E as n,D as i,d as u}from"./chunks/framework.CuLWBCQE.js";const A=JSON.parse('{"title":"On Player Leave","description":"This system will run your desired commands on the event that a player leaves the world.","frontmatter":{"title":"On Player Leave","category":"On Event Systems","mentions":["BedrockCommands","zheaEvyline"],"nav_order":3,"description":"This system will run your desired commands on the event that a player leaves the world."},"headers":[{"level":2,"title":"Introduction","slug":"introduction","link":"#introduction","children":[]},{"level":2,"title":"Setup","slug":"setup","link":"#setup","children":[]},{"level":2,"title":"System","slug":"system","link":"#system","children":[]},{"level":2,"title":"Explanation","slug":"explanation","link":"#explanation","children":[]},{"level":2,"title":"Tick JSON","slug":"tick-json","link":"#tick-json","children":[]}],"relativePath":"commands/on-player-leave.md","filePath":"commands/on-player-leave.md"}'),h={name:"commands/on-player-leave.md"},m=s('<h2 id="introduction" tabindex="-1">Introduction <a class="header-anchor" href="#introduction" aria-label="Permalink to &quot;Introduction&quot;">​</a></h2><p><a href="https://discord.gg/SYstTYx5G5" target="_blank" rel="noreferrer">Sourced By Bedrock Commands Community Discord</a></p><p>This system will run your desired commands on the event that a player leaves the world.</p><blockquote><p>Note: You cannot execute commands on the <em>players</em> that leave using target selectors. However, you may use the <a href="/commands/on-player-join.html">On Player Join</a> system to execute when they join back.</p></blockquote><h2 id="setup" tabindex="-1">Setup <a class="header-anchor" href="#setup" aria-label="Permalink to &quot;Setup&quot;">​</a></h2><p><em>To be typed in Chat:</em></p><p><code>/scoreboard objectives add total dummy</code></p><p>If you are working with functions and prefer to have the objective added automatically on world initialisation, follow the process outlined in <a href="/commands/on-first-world-load.html">On First World Load.</a></p><h2 id="system" tabindex="-1">System <a class="header-anchor" href="#system" aria-label="Permalink to &quot;System&quot;">​</a></h2>',9),y=s(`<div class="language-yaml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">## Entity Counter</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">### reset current player count</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">scoreboard players reset NewPlayerCount total</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">### get current player count </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">execute as @a run scoreboard players add NewPlayerCount total 1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">## Get Difference ( current - previous )</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">scoreboard players operation newPlayerCount total -= playerCount total</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">## Your Commands Here (example)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">### message if there is a difference of -1 or less</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">execute if score newPlayerCount total matches ..-1 run say a player has left the world</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">## Entity Counter</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">### reset current player count</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">scoreboard players reset playerCount total</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">### get current player count (to check difference next game tick)</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">execute as @a run scoreboard players add playerCount total 1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><img src="`+r+'" alt="Chain of 6 Command Blocks"></p><p>Here, we have used a <code>/say</code> command as an example, but you can use any command you prefer and as many as you need.</p><p>Just make sure to follow the given order and properly apply the <code>/execute if score</code> condition as shown for your desired commands.</p><h2 id="explanation" tabindex="-1">Explanation <a class="header-anchor" href="#explanation" aria-label="Permalink to &quot;Explanation&quot;">​</a></h2><ul><li><strong><code>NewPlayerCount</code></strong> total number of players on the world in the current game-tick (at start of command loop).</li><li><strong><code>PlayerCount</code></strong> total number of players on the world in the current game-tick (by the end of command loop).</li></ul><p>Since <code>PlayerCount</code> is only updated at the end of the command loop, it can be used at the start of the command loop in the next game-tick to check difference with <code>NewPlayerCount</code>.</p><p>The count is obtained using the <a href="/commands/entity-counter.html">Entity Counter</a> system. It may be beneficial to refer to that page to better understand this one. When referring to that page, you will notice that we have used the objective name <code>total</code> instead of <code>count</code>. This is to prevent collision between the two systems.</p><p>By subtracting &#39;playerCount&#39; total from &#39;newPlayerCount&#39; total, we will be able to identify if the player count has:</p><ul><li>decreased <code>..-1</code></li><li>increased <code>1..</code></li><li>or if it&#39;s unchanged <code>0</code></li></ul><p>If it has decreased, we know that 1 or more players have left the game. Using this knowledge, we can run our desired commands from &#39;newPlayerCount&#39; if it&#39;s score is <code>-1</code> or less.</p><ul><li><p>i.e., if there were 10 players and someone leaves:</p><ul><li>that is <code>NewPlayerCount - PlayerCount</code></li><li>which results <code>9 - 10 = -1</code></li><li>hence, we will detect by <code>..-1</code></li></ul></li><li><p>The &#39;NewPlayerCount&#39; total is obtained first, subtraction is performed after that to run your desired commands, and lastly, the &#39;PlayerCount&#39; total is obtained to be used in the next game-tick.</p></li></ul><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>All commands involved in a command-block-chain or function will only run in a sequence one after the other but it all still happens in the same tick regardless of the number of commands involved. We are able to achieve this system due to the fact that commands run along the end of a game tick after all events such as player log in, log out, death, etc.. occur.</p><p><img src="'+c+'" alt="gametick"></p></div><h2 id="tick-json" tabindex="-1">Tick JSON <a class="header-anchor" href="#tick-json" aria-label="Permalink to &quot;Tick JSON&quot;">​</a></h2><p>If you are using functions instead of command blocks, the <code>on_leave</code> function must be added to the <code>tick.json</code> in order to loop and run it continuously. Multiple files can be added to the <code>tick.json</code> by placing a comma after each string. Refer to <a href="/commands/mcfunctions.html#tick-json">Functions</a> documentation for further info.</p>',15),b=s(`<div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;values&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;events/player/on_leave&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>If using functions, your pack folder structure will be as follows:</p>`,2),k=e("div",{class:"info custom-block"},[e("p",{class:"custom-block-title"},"NOTE:"),e("p",null,[n("The scoreboard names (in this case: 'total') may end up being used by other people. Appending "),e("code",null,"_"),n(" and a set of randomly generated characters after would be a choice that reduces the probability of collisions. Similar technique can be employed for the "),e("code",null,".mcfunction"),n(" filenames. Ex:")]),e("ul",null,[e("li",null,[e("code",null,"total_0fe678")]),e("li",null,[e("code",null,"on_leave_0fe678.mcfunction")])])],-1);function f(g,_,v,w,C,P){const t=i("CodeHeader"),l=i("FolderView");return u(),d("div",null,[m,a(t,null,{default:o(()=>[n("BP/functions/events/player/on_leave.mcfunction")]),_:1}),y,a(t,null,{default:o(()=>[n("BP/functions/tick.json")]),_:1}),b,a(l,{paths:["BP","BP/functions","BP/pack_icon.png","BP/manifest.json","BP/functions/events","BP/functions/events/player","BP/functions/events/player/on_leave.mcfunction","BP/functions/tick.json"]}),k])}const F=p(h,[["render",f]]);export{A as __pageData,F as default};
